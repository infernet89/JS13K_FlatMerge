var c,d,e,f,g=0,h=[],k=null,l=null,m,n=null,p=null,q=null,t=[],u=-100,v=-100;c=document.getElementById("g");f=c.getContext("2d");d=c.width=window.innerWidth;e=c.height=window.innerHeight;var w="  #DDD #c1ba00 #D00 #50D #050 #0DD #D50 #D55 #5D5 #0F0".split(" ");c.addEventListener("mousemove",x);c.addEventListener("mousedown",y);c.addEventListener("mouseup",z);g=0;A();setInterval(B,33);
function A(){h=[];t=[];l=k=null;tmp={size:20};tmp.x=d-140;tmp.y=e-40;tmp.rotation=C(0,360);tmp.a=0;tmp.b=0;tmp.c=.5;tmp.type=g+3;tmp.color=w[g+3];tmp.f=!0;h.push(tmp);m=tmp;if(0==g)for(D(d/2-400,110,800,150,[""]),D(50,450,280,60,["","Don't worry, you will learn through the way."]),D(d/2-50,e-200,100,100,[""]),m.size=45,m.x=d/2,m.y=e-150,E(3),i=0;4>i;i++)E(2),E(4),E(5),E(6),E(7),E(8),E(9),E(10),E(11);else if(1==g){D(200,200,200,45,["LOST: unable to find the way.","                  -Merriam-Webster"]);
D(150,300,430,30,["Sometimes, you don't even know WHAT is the way you need to find"]);for(i=0;3>i;i++)E(3);for(i=0;77>i;i++)E(2)}else if(2==g){D(150,200,340,45,["If you are feeling some confusion, it's perfectly fine.","It's really hard to find our way in life"]);E(4);for(i=0;5>i;i++)E(3);for(i=0;15>i;i++)E(2)}else if(3==g){D(150,200,650,45,["Have you ever tried to hit something that is moving, while you are also moving in a different direction?","That's what finding our way in life feels like."]);
D(420,500,240,30,["Because we're all work-in-progress."]);E(5);for(i=0;11>i;i++)E(3);for(i=0;9>i;i++)E(2)}else if(4==g){D(150,200,530,65,["One day some things matter, and another day those things doesn't matter anymore.","You'll never know.","You can't predict what will matter someday."]);D(150,400,320,30,["Do you know what REALLY matter in this world?"]);D(550,480,120,30,["CONNECTIONS"]);for(i=0;3>i;i++)E(5);for(i=0;19>i;i++)E(3);for(i=0;9>i;i++)E(2)}else if(5==g){D(150,200,290,30,["You will not be able to connect to everyone."]);
D(150,300,345,30,["You need to find someone that is kinda similar to you."]);D(150,400,250,30,["The people you know will change you."]);D(150,500,500,30,["And, surprisingly, you will find connections in people you wasn't able to relate."]);D(440,600,210,65,["Wait.","","You had already figured it out?"]);for(i=0;2>i;i++)E(6);for(i=0;33>i;i++)E(3);for(i=0;7>i;i++)E(2)}else if(6==g){D(150,200,390,280,"The research for your way in life is endless.;It's something biologically attached to our DNA,;something that helped the mankind to evolve until this point.;;Every great discovery was done because someone;missed something. Wanted to get more from his life.;;Do you really think that internet was made for cats?;It was made to gain access to all existing;information, in a single second.;So, you can browse searching for a purpose.;;We constantly need something more.;We are never satisfied.;So we will always search new stimuli.;;And this research will never end.".split(";"));
D(580,520,125,35,["Unlike this game."]);E(7);E(6);E(6);E(5);E(5);E(5);E(4);E(4);E(4);E(4);E(4);E(4);E(4);for(i=0;87>i;i++)E(3);for(i=0;3>i;i++)E(2)}else if(7==g){D(150,100,135,50,["This game will end","But so is your life."]);D(250,200,200,50,["The end will be disappointing","Like your life."]);D(30,300,160,50,["Filled with negativity.","Like your life."]);D(250,400,170,50,["You will want to give up","Like in your life"]);D(50,550,380,50,["Everyhing you have done to reach this point will be useless",
"Like.. well, you get it."]);D(380,620,50,35,["But.."]);for(i=0;255>i;i++)E(3);for(i=0;5>i;i++)E(2)}else if(8==g){D(150,100,270,100,["Life is not about finding the way.","It's not about reaching your destination.","","It's all about the journey.","And about what you will learn during it."]);D(10,300,270,35,["And I think you learned something here.."]);E(10);E(9);E(9);E(8);E(8);E(8);E(7);E(7);E(7);E(6);E(6);E(6);E(6);E(5);E(5);E(5);E(5);E(5);E(4);E(4);E(4);E(4);E(4);E(4);for(i=0;131>i;i++)E(3);for(i=
0;9>i;i++)E(2)}else 9==g&&(D(d/2-150,e/2-150,300,300,";;;;;;;;                 Perfection is useless;;                     keep your edges".split(";")),tmp={size:120,rotation:0,a:0,b:0,c:0},tmp.x=d/2,tmp.y=e/2,tmp.type=11,tmp.color="#00F",tmp.f=!1,tmp.g=!0,h.push(tmp),tmp={size:170,rotation:0,a:0,b:0,c:1},tmp.x=d/2,tmp.y=e/2,tmp.type=10,tmp.color="#0F0",tmp.f=!1,tmp.g=!0,h.push(tmp),tmp={size:190,rotation:0,a:0,b:0,c:-1},tmp.x=d/2,tmp.y=e/2,tmp.type=9,tmp.color="#F00",tmp.f=!1,tmp.g=!0,h.push(tmp),
tmp={size:210,rotation:0,a:0,b:0,c:1},tmp.x=d/2,tmp.y=e/2,tmp.type=8,tmp.color="#F0F",tmp.f=!1,tmp.g=!0,h.push(tmp),tmp={size:230,rotation:0,a:0,b:0,c:-1},tmp.x=d/2,tmp.y=e/2,tmp.type=7,tmp.color="#FF0",tmp.f=!1,tmp.g=!0,h.push(tmp),tmp={size:250,rotation:0,a:0,b:0,c:1},tmp.x=d/2,tmp.y=e/2,tmp.type=6,tmp.color="#0FF",tmp.f=!1,tmp.g=!0,h.push(tmp))}function D(b,a,r,I,J){tmp={};tmp.x=b;tmp.y=a;tmp.width=r;tmp.height=I;tmp.color="#FFF";tmp.text=J;t.push(tmp)}
function E(b){unplaceable=!0;tmp={size:16};do tmp.x=C(2*tmp.size,d-tmp.size),tmp.y=C(2*tmp.size,e-tmp.size);while(F());tmp.rotation=C(0,360);tmp.a=C(-4,4);tmp.b=C(-4,4);tmp.c=C(-4,4);tmp.type=b;tmp.color=w[tmp.type];tmp.f=!1;tmp.g=!1;h.push(tmp)}function G(){var b=k,a=l,r=!0;if(a==m)return!0;cx=(b.x+a.x)/2;cy=(b.y+a.y)/2;tmp={};tmp.size=b.size;tmp.x=b.x;tmp.y=b.y;tmp.a=(cx-b.x)/20;tmp.b=(cy-b.y)/20;for(i=0;40>i;i++)if(tmp.x+=tmp.a,tmp.y+=tmp.b,F()){r=!1;break}return r}
function F(){var b=tmp,a=!1;if(b.x+b.size>d-180&&b.y+b.size>e-80)return!0;t.forEach(function(r){if(b.x+b.size>r.x&&b.x-b.size<r.x+r.width&&b.y+b.size>r.y&&b.y-b.size<r.y+r.height)return a=!0});return a}
function B(){f.clearRect(0,0,d,e);f.fillStyle="#000";f.fillRect(0,0,d,e);f.fillStyle="#FFF";f.fillRect(0,0,d,1);f.fillRect(0,e-1,d,1);f.fillRect(0,0,1,e);f.fillRect(d-1,0,1,e);9>g&&0!=g&&(f.fillStyle="#FFF",f.fillRect(d-180,e-80,250,2),f.fillRect(d-180,e-80,2,80),f.font="20px Arial",f.fillText("NEXT",d-90,e-50),f.fillText("LEVEL",d-90,e-20));noneSelected=!0;hover=!1;h.forEach(function(b){H(b);b.x+=b.a;b.y+=b.b;b.rotation+=b.c;if(!b.g){if(b.x+b.a>d-b.size||b.x+b.a<b.size)b.a*=-1;if(b.y+b.b>e-b.size||
b.y+b.b<b.size)b.b*=-1;b.x+b.size>d-180&&b.y+b.b+b.size>e-80&&(b.b*=-1);b.x+b.a+b.size>d-180&&b.y+b.size>e-80&&(b.a*=-1);t.forEach(function(a){b.x+b.size>a.x&&b.x-b.size<a.x+a.width&&b.y+b.size+b.b>a.y&&b.y-b.size+b.b<a.y+a.height&&(b.b*=-1);b.y+b.size>a.y&&b.y-b.size<a.y+a.height&&b.x+b.size+b.a>a.x&&b.x-b.size+b.a<a.x+a.width&&(b.a*=-1)});0==g&&h.forEach(function(a){a!=b&&b.x+b.size>a.x&&b.x-b.size<a.x+a.size&&b.y+b.size+b.b>a.y&&b.y-b.size+b.b<a.y+a.size&&(b.b*=-1);a!=b&&b.y+b.size>a.y&&b.y-b.size<
a.y+a.size&&b.x+b.size+b.a>a.x&&b.x-b.size+b.a<a.x+a.size&&(b.a*=-1)})}});t.forEach(function(b){f.fillStyle="#FFF";f.fillRect(b.x,b.y,b.width,2);f.fillRect(b.x,b.y,2,b.height);f.fillRect(b.x+b.width-2,b.y,2,b.height);f.fillRect(b.x,b.y+b.height-2,b.width,2);f.font="14px Arial";for(i=0;i<b.text.length;i++)f.fillText(b.text[i],b.x+10,20+b.y+15*i)});null!=k&&null!=l?(f.beginPath(),G()?f.strokeStyle="#6F6":f.strokeStyle="#600",f.moveTo(l.x,l.y),f.lineTo(k.x,k.y),f.lineWidth=3,f.stroke(),f.closePath()):
null!=k&&0!=g&&(f.beginPath(),f.strokeStyle="#FFF",f.moveTo(u,v),f.lineTo(k.x,k.y),f.lineWidth=3,f.stroke(),f.closePath());null!=n&&null!=p&&(n.x-p.x)*(n.x-p.x)<n.size&&(n.y-p.y)*(n.y-p.y)<n.size&&(q.type=n.type+1,q.x=n.x,q.y=n.y,q.color=w[q.type],q.size=(n.size+p.size)/2,h.splice(h.indexOf(n),1),h.splice(h.indexOf(p),1),h.push(q),p==m&&(g++,A()),p=n=null);0==g&&(f.fillStyle="#FFF",f.font="50px Arial",f.fillText("Have you missed the",d/2-390,160),f.font="80px Arial",f.fillText("TUTORIAL for LIFE?",
d/2-350,240),f.fillStyle="#000",f.font="20px Arial",f.fillText("PLAY",d/2-25,e-145),k=h[1],f.fillStyle="#FFF",f.font="12px Arial",f.fillText("By Infernet89",d-75,e-5),f.fillText("Made for JS13k Competition",5,e-5))}function K(){for(i=0;i<h.length;i++)if(u+20>h[i].x-h[i].size&&u<h[i].x+h[i].size&&v+20>h[i].y-h[i].size&&v<h[i].y+h[i].size)return h[i];return null}
function H(b){var a=b.size;f.save();f.translate(b.x,b.y);f.rotate(b.rotation*Math.PI/180);f.beginPath();2==b.type?(f.moveTo(0,-a/2),f.lineTo(0,a/2),f.moveTo(-a/2,0),f.lineTo(a/2,0),f.moveTo(-a/2,-a/2),f.lineTo(a/2,a/2),f.moveTo(-a/2,a/2),f.lineTo(a/2,-a/2)):3==b.type?(f.moveTo(0,-a),f.lineTo(-.87*a,.5*a),f.lineTo(.87*a,.5*a),f.lineTo(0,-a)):4==b.type?(f.moveTo(-a,-a),f.lineTo(a,-a),f.lineTo(a,a),f.lineTo(-a,a),f.lineTo(-a,-a)):5==b.type?(f.moveTo(0,-a),f.lineTo(-.95*a,-.31*a),f.lineTo(-.59*a,.81*
a),f.lineTo(.59*a,.81*a),f.lineTo(.95*a,-.31*a),f.lineTo(0,-a)):6==b.type?(f.moveTo(.5*a,-.87*a),f.lineTo(-.5*a,-.87*a),f.lineTo(-a,0),f.lineTo(-.5*a,.87*a),f.lineTo(.5*a,.87*a),f.lineTo(a,0),f.lineTo(.5*a,-.87*a)):7==b.type?(f.moveTo(0,-a),f.lineTo(-.78*a,-.62*a),f.lineTo(-.97*a,.22*a),f.lineTo(-.43*a,.9*a),f.lineTo(.43*a,.9*a),f.lineTo(.97*a,.22*a),f.lineTo(.78*a,-.62*a),f.lineTo(0,-a)):8==b.type?(f.moveTo(-a/2,-a),f.lineTo(a/2,-a),f.lineTo(a,-a/2),f.lineTo(a,a/2),f.lineTo(a/2,a),f.lineTo(-a/2,
a),f.lineTo(-a,a/2),f.lineTo(-a,-a/2),f.lineTo(-a/2,-a)):9==b.type?(f.moveTo(0,-a),f.lineTo(-.64*a,-.77*a),f.lineTo(-.98*a,-.17*a),f.lineTo(-.87*a,a/2),f.lineTo(-.34*a,.94*a),f.lineTo(.34*a,.94*a),f.lineTo(.87*a,a/2),f.lineTo(.98*a,-.17*a),f.lineTo(.64*a,-.77*a),f.lineTo(0,-a)):10==b.type?(f.moveTo(.31*a,-.95*a),f.lineTo(-.31*a,-.95*a),f.lineTo(-.81*a,-.59*a),f.lineTo(-a,0),f.lineTo(-.81*a,.59*a),f.lineTo(-.31*a,.95*a),f.lineTo(.31*a,.95*a),f.lineTo(.81*a,.59*a),f.lineTo(a,0),f.lineTo(.81*a,-.59*
a),f.lineTo(.31*a,-.95*a)):11==b.type&&f.arc(0,0,a,0,2*Math.PI,!1);f.closePath();f.lineWidth=1;f.strokeStyle=b.color;f.fillStyle=b.color;b.f?f.fill():f.stroke();f.restore()}function C(b,a){return b>a?C(a,b):Math.floor(Math.random()*(a+1-b)+b)}function y(b){var a=c.getBoundingClientRect();u=(b.clientX-a.left)/(a.right-a.left)*d;v=(b.clientY-a.top)/(a.bottom-a.top)*e;null!=k&&(k.f=!1);k=K();null!=k&&(2>=k.type||k==m)&&(k=null);null!=k&&(k.f=!0)}
function x(b){var a=c.getBoundingClientRect();u=(b.clientX-a.left)/(a.right-a.left)*d;v=(b.clientY-a.top)/(a.bottom-a.top)*e;null!=k&&(l=K(),null!=l&&l.type!=k.type&&(l=null))}function z(){null!=k&&(null!=l&&l!=k&&G()?(l.f=!0,n=k,p=l,q={},q.a=n.a+p.a,q.a%=4,q.b=n.b+p.b,q.b%=4,q.rotation=0,q.c=n.c+p.c,q.c%=4,q.g=!1,cx=(n.x+p.x)/2,cy=(n.y+p.y)/2,n.a=(cx-n.x)/20,n.b=(cy-n.y)/20,n.g=!0,p.g=!0,p!=m&&(p.a=(cx-p.x)/20,p.b=(cy-p.y)/20)):k.f=!1);l=k=null};